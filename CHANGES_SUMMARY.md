# ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## 1Ô∏è‚É£ –û–¥–∏–Ω –º–∞–≥–∞–∑–∏–Ω –Ω–∞ –≤–µ–Ω–¥–æ—Ä–∞ ‚úÖ

### Backend:
- ‚úÖ **Prisma –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ë–î –≤–º–µ—Å—Ç–æ mock
- ‚úÖ **Upsert –ª–æ–≥–∏–∫–∞** - `prisma.store.upsert({ where: { merchantId } })`
- ‚úÖ **–ù–æ–≤—ã–π endpoint** - `GET /api/stores/vendor/:merchantId`
- ‚úÖ **Constraint** - `merchantId` —É–∂–µ –∏–º–µ–µ—Ç `@unique` –≤ schema

### Frontend:
- ‚úÖ **API –º–µ—Ç–æ–¥** - `storesApi.getVendorStore(merchantId)`
- ‚úÖ **Store Settings** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "One Store Per Vendor" –∏–Ω—Ñ–æ
- ‚úÖ **Dashboard** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

### Migration:
- ‚úÖ **–°–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏** - `server/scripts/clean-duplicate-stores.ts`
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - `MIGRATION_ONE_STORE.md`

---

## 2Ô∏è‚É£ –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –¥–ª—è –≤–µ–Ω–¥–æ—Ä–æ–≤ ‚úÖ

### –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:
- ‚úÖ **VendorOnboarding.tsx** - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –≤–µ–Ω–¥–æ—Ä–æ–≤
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** - –µ—Å–ª–∏ —É –≤–µ–Ω–¥–æ—Ä–∞ –Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–∞ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
- ‚úÖ **–ö—Ä–∞—Å–∏–≤—ã–π UI** - —Å —ç–º–æ–¥–∑–∏, —à–∞–≥–∞–º–∏ –∏ –∏–Ω—Ñ–æ-–±–æ–∫—Å–∞–º–∏

### –õ–æ–≥–∏–∫–∞:
```typescript
// –í MerchantDashboard:
const checkStoreAndFetchData = async () => {
    const stores = await storesApi.getAll();
    const vendorHasStore = stores.length > 0;
    setHasStore(vendorHasStore);
    
    if (!vendorHasStore) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º VendorOnboarding
        return <VendorOnboarding />;
    }
    // –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–π Dashboard
};
```

### –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –≤–∫–ª—é—á–∞–µ—Ç:
1. –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–º–µ–Ω–µ–º –≤–µ–Ω–¥–æ—Ä–∞
2. **3 —à–∞–≥–∞**: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω ‚Üí –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å ‚Üí —Å–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä
3. –í–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–∏—Ç–∏–∫–µ –æ–¥–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
4. –ö–Ω–æ–ø–∫–∞ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω" ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ Store Settings

---

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:

```
src/features/merchant/VendorOnboarding.tsx                 - –û–Ω–±–æ—Ä–¥–∏–Ω–≥ UI
server/scripts/clean-duplicate-stores.ts                  - –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
MIGRATION_ONE_STORE.md                                    - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
src/features/merchant/Dashboard.tsx                       - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞
src/api/stores.ts                                         - –î–æ–±–∞–≤–ª–µ–Ω getVendorStore()
server/src/controllers/stores.controller.ts               - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω Prisma + upsert
server/src/routes/stores.routes.ts                        - –î–æ–±–∞–≤–ª–µ–Ω /vendor/:merchantId
```

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### 1. –ù–æ–≤—ã–π –≤–µ–Ω–¥–æ—Ä (–±–µ–∑ –º–∞–≥–∞–∑–∏–Ω–∞):
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173/merchant
2. –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å—Å—è VendorOnboarding —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º
3. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ Store Settings
5. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ Dashboard ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –æ–±—ã—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```

### 2. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤–µ–Ω–¥–æ—Ä (—Å –º–∞–≥–∞–∑–∏–Ω–æ–º):
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ /merchant ‚Üí –æ–±—ã—á–Ω—ã–π Dashboard
2. –ó–∞–π–¥–∏—Ç–µ –≤ Store Settings
3. –ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–¥—Ä–µ—Å)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ ‚Üí –¥–æ–ª–∂–µ–Ω –û–ë–ù–û–í–ò–¢–¨ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–∞–≥–∞–∑–∏–Ω (–Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π)
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î:
```bash
cd server
npx prisma studio
```
–û—Ç–∫—Ä–æ–µ—Ç—Å—è Prisma Studio ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ merchant –º–∞–∫—Å–∏–º—É–º 1 store.

---

## üöÄ –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

```bash
# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
cd server
npx prisma generate

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã)
npx prisma migrate dev --name one_store_per_vendor

# 3. –û—á–∏—Å—Ç–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
npx tsx scripts/clean-duplicate-stores.ts

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
npm run dev
```

---

## ‚ú® –ß—Ç–æ —É–ª—É—á—à–µ–Ω–æ:

| –î–æ | –ü–æ—Å–ª–µ |
|----|--------|
| –í–µ–Ω–¥–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ –º–∞–≥–∞–∑–∏–Ω–æ–≤ | –¢–æ–ª—å–∫–æ 1 –º–∞–≥–∞–∑–∏–Ω –Ω–∞ –≤–µ–Ω–¥–æ—Ä–∞ |
| Mock –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ | –†–µ–∞–ª—å–Ω–∞—è Prisma –ë–î |
| –ù–µ—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ | –ö—Ä–∞—Å–∏–≤—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ |
| –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –º–∞–≥–∞–∑–∏–Ω–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ |
| –°–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å —á—Ç–æ –¥–µ–ª–∞—Ç—å | –ß–µ—Ç–∫–∏–µ —à–∞–≥–∏ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ |

---

## üìå –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **Constraint —Ä–∞–±–æ—Ç–∞–µ—Ç** - `merchantId @unique` –≤ Prisma schema
2. **Upsert –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã** - –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç, –Ω–µ —Å–æ–∑–¥–∞–µ—Ç
3. **–û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑** - –ø–æ–∫–∞ –≤–µ–Ω–¥–æ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –º–∞–≥–∞–∑–∏–Ω
4. **Cascade delete** - –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –º–∞–≥–∞–∑–∏–Ω–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –µ–≥–æ –æ—Ñ—Ñ–µ—Ä—ã

---

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ development/production –¥–µ–ø–ª–æ—é.

**Servers**: 
- Backend: http://localhost:3001 ‚úÖ
- Frontend: http://localhost:5173 ‚úÖ
